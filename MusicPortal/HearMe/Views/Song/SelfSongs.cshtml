@model IEnumerable<HearMe.BLL.DTM.SongDTM>

@{
    ViewData["Title"] = "SelfSongs";
}

<div class="songs-list">
    <h3>Songs list</h3>
    <p>
        <a asp-controller="Song" asp-action="Create">Add new song</a>
    </p>
    @foreach (var item in Model)
    {
        <div class="song-container">
            <img src="@item.PreviewPath" alt="preview" />
            <div class="name-genre">
                <h5>@item.Name</h5>
                <p>@item.GenreName</p>
            </div>

            <button id="btn-play">
                <span class="material-symbols-outlined">
                    play_circle
                </span>
                <input id="path" type="hidden" value="@item.SongPath" />
            </button>

            <div class="user-login">
                <p class="user">@item.UserLogin</p>
            </div>

            @if (Context.Request.Cookies["Login"] == item.UserLogin)
            {
                <div class="buttons">
                    <button><a asp-action="Edit" asp-controller="Song" asp-route-id="@item.Id">Edit</a></button>
                    <button><a asp-action="Details" asp-controller="Song" asp-route-id="@item.Id">Details</a></button>
                    <button><a asp-action="Delete" asp-controller="Song" asp-route-id="@item.Id">Delete</a></button>
                </div>
            }
        </div>
    }
</div>
@section Scripts {
    <script>
        const playbtns = document.querySelectorAll('#btn-play');
        const player = document.getElementById("audio");
        playbtns.forEach((el) => {
            el.addEventListener("click", (ev) => {
                ev.preventDefault();
                const path = el.querySelector("#path");
                player.src = path.value;
                player.play();
            });
        });
    </script>
}